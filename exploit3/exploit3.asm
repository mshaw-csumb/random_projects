BITS 32
section .text

extern gets
extern printf


global main

;copy the structure of exploit3.c
;void spawnshell()
;void vulnerable() where a local variable is used for name
;start will take the place of main

main:


	call vulnerable
	
	mov eax, 1
	mov ebx, 0
	int 0x80



vulnerable:

	push ebp
	mov ebp, esp
	sub esp, 16 ;16 bytes for the char array name 
	;ebp-16 will be the stack address for the local variable name
	
	push prompt1 ;second arg
	push fmt ;first arg

	call printf
	add esp, 8 ;cleanup the stack
	
	
	mov esp, ebp
	pop ebp
	ret
	


	
section .data

	prompt1 db "Tell me your name, and I might give you the flag",0
	prompt2 db "you said: ",0
	fmt	db "%s",10,0
